services:
  prepa12-app:
    build: .   # Ruta al Dockerfile o carpeta de proyecto
    platform: linux/amd64  # Forzar a construir para arquitectura amd64
    ports:
      - "8080:8080"
    environment:
      DB_URL: jdbc:postgresql://todo_db:5432/mydatabase?currentSchema=public
      DB_USER_NAME: postgres
      DB_PASSWORD: 1234
    restart: always
    depends_on:
      prepa12_db:
        condition: service_healthy
  prepa12_db:
    image: postgres:14.5  # Cambia la imagen de MySQL a PostgreSQL
    ports:
      - "5432:5432"  # Puerto predeterminado de PostgreSQL
    environment:
      POSTGRES_USER: kell  # Usuario predeterminado de PostgreSQL
      POSTGRES_PASSWORD: 1234  # Contrase√±a de la base de datos
      POSTGRES_DB: mydatabase  # Nombre de la base de datos
    restart: always
    healthcheck:
      test: ["CMD", "pg_isready", "-U", "postgres"]  # Comando de healthcheck para PostgreSQL
      timeout: 10s
      retries: 10
